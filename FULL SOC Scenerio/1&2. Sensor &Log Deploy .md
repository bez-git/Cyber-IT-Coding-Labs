# Lab 1 & 2: Sensor Deployment & Log Forwarding

**Mission:** Deploy a virtualized Network Sensor (Zeek/Suricata) to capture and analyze network traffic, and establish a pipeline to forward logs to a SIEM for threat detection.
**Key Skills:** Virtualization (VMware), Network Interface Promiscuous Mode, Log Generation, SPAN/Port Mirroring.

---

## 1. Network Topology
The physical infrastructure was architected to simulate a real-world edge network.

* **ISP Hand-off:** Fiber connection enters via the Ciena Box (Wall Jack).
* **Gateway:** AT&T Gateway authenticates the fiber signal.
* **Firewall:** FortiGate 60F connected via WAN port to the AT&T Gateway.
* **LAN Distribution:** TP-Link Managed Switch connects the FortiGate to the Local Office endpoints (Laptop/Sensor).

<p align="center">
  <img width="400" height="350" alt="Topology 1" src="https://github.com/user-attachments/assets/05b43a19-3f80-4bb2-8550-7e2f11f94de3" />
  <img width="400" height="350" alt="Topology 2" src="https://github.com/user-attachments/assets/c5973d53-acac-43f3-a606-c0b079a9a5c0" />
  <br>
  <img width="400" height="350" alt="Topology 3" src="https://github.com/user-attachments/assets/6207e59d-24a5-4336-a5c7-b35607533ff5" />
  <img width="400" height="350" alt="Topology 4" src="https://github.com/user-attachments/assets/0aa7213e-4f17-4f48-9064-7a6062c44d2f" />
</p>

---

## 2. Virtual Machine & Sensor Setup
The sensor VM required a specific networking configuration to ingest raw traffic without IP conflicts.

* **Host Hardware:** Laptop with 1 Internal NIC + 1 External USB Ethernet Adapter.
* **VM Network Mapping:**
    * **Adapter 1 (NAT):** Used for Management/Internet access (so the VM can update and talk to the SIEM).
    * **Adapter 2 (Bridged - VMnet0):** Mapped specifically to the **USB Ethernet Adapter**.
    * Constraint Solved: VMware's Network Editor was unlocked to force VMnet0 to bridge only to the USB adapter, ensuring it captured traffic from the Switch SPAN port (Port 18).
* **Switch Configuration:**
    * **Port 16:** Uplink/Internet.
    * **Port 18:** SPAN (Mirror) Port – Copying all firewall traffic to the Sensor.
 

<p align="center">
<img width="400" height="350" alt="VM Settings" src="https://github.com/user-attachments/assets/68281db9-67c6-4a28-8c01-03d0590ae4ac" />
<img width="400" height="350" alt="Network Editor" src="https://github.com/user-attachments/assets/ad478419-2f2e-4601-9e5c-cc432fd98ff9" />
</p>

### Sensor Initialization
* Configured the sensor interface for DHCP (via NAT adapter) to retrieve an IP.
* Uploaded the custom ThreatDefense configuration file via the web interface.
<img width="800" alt="Config Upload" src="https://github.com/user-attachments/assets/8bc52380-3657-468c-8709-f367e9d0f19a" />


---

## 3. Verification & Testing
Validated the sensor's ability to see traffic using CLI tools.
  *  Visited - http://neverssl.com -(HTTP Unencrypted)
  *  Ran  tcpdump -i ens34 port 80
<img width="800" height="700" alt="image" src="https://github.com/user-attachments/assets/22781de5-5470-4695-9a09-2dcb021f2c32" />

---
## 4. CLI Analysis Commands  & IDS Log Validation 
    *  htop / top - Visual bar graph of your CPU and Memory usage.
    *  grep "google" /var/log/syslog - Searches for specific text inside files.
    *  tcpdump -i ens34 port 80 or port 443 - Who is browsing the web? (Filter by Port 80/443)
    *  tcpdump -i ens34 host 8.8.8.8 - Is anyone talking to Google? (Filter by IP)
    *  tcpdump -i ens34 -A port 80 - Read the mail (ASCII Mode)
    *  tcpdump -i ens34 -q - Summary for each Packet
    *  cd /usr/local/zeek/logs/current - ls
    *  Suritica IDS confirmation --  tail -f /data/zeek/log/rnanager/conn. log — 
    *  Confirmed that Suricata and Zeek were generating logs in real-time.
      *    find / -name "fast.log" tail - f /data/suricata/log/fast.log
          *  cd /usr/local/zeek/logs/current
          *  ls -lh  -- # List active log files
          *  tail -f /data/suricata/log/fast.log
   
<img width="400" height="350" alt="image" src="https://github.com/user-attachments/assets/c6a35de1-6275-4472-9ffd-93fb2ef0034b" />
<img width="400" height="350" alt="image" src="https://github.com/user-attachments/assets/183bfc08-5bc2-417e-a176-d83a347f75f6" />
<img width="400" height="350" alt="image" src="https://github.com/user-attachments/assets/901bc75d-5c95-432f-8f55-69c393955a83" />
<img width="400" height="350" alt="image" src="https://github.com/user-attachments/assets/96908ef9-a299-4471-b1b6-27ecdacc1d5b" />

 
## 5. SIEM Integration Check
* Verifying that the sensor detected an attack signature and forwarded the alert to the SIEM dashboard.
* Trigger: Visited http://testmyids.com (Generates a benign GPL ATTACK_RESPONSE signature).
* Result: The sensor flagged the traffic, and the SIEM visualized the alert immediately.
 <img width="400" height="350" alt="image" src="https://github.com/user-attachments/assets/9ca8fdf1-14dc-47f0-9817-d8fe1a16353f" />
 <img width="400" height="350" alt="image" src="https://github.com/user-attachments/assets/7444f80c-f6bd-4e95-bd5d-94d52b11bd15" />


# Lab 1 & 2 Summary 
- Architected a physical security monitoring solution using Port Mirroring (SPAN) on a managed switch to capture East-West and North-South traffic.
- Deployed and configured a Linux-based Network Sensor (Zeek/Suricata) in a virtualized environment (VMware).
- Implemented Traffic Isolation by bridging a dedicated USB network interface to the SPAN port, ensuring zero interference with management traffic.
- Validated the detection pipeline by executing test traffic (testmyids.com) and verifying log ingestion in the SIEM Dashboard.










